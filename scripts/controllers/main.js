!function(){"use strict";function mainCtrl($scope,$state,DataStore,$csv){function validateInputs(){$scope.selectedOrigin!==$scope.chosenOrigin&&$scope.selectedDest!==$scope.chosenDest?$state.go("dashboard.chart",{selectedOrigin:$scope.selectedOrigin,selectedDest:$scope.selectedDest}):($scope.statsForm.origin.$setValidity("empty",!1),$scope.statsForm.dest.$setValidity("empty",!1),$scope.invalidInputs={origin:$scope.selectedOrigin===$scope.chosenOrigin,dest:$scope.selectedDest===$scope.chosenDest})}function getAllDest(flightsJSON){$scope.allDestArray=[],flightsJSON.forEach(function(flightObj){-1===$scope.allDestArray.indexOf(flightObj.ORIGIN)&&$scope.allDestArray.push(flightObj.ORIGIN),-1===$scope.allDestArray.indexOf(flightObj.DEST)&&$scope.allDestArray.push(flightObj.DEST)})}function convertCsvToJson(flightsCSV){return $csv.convertStringToJson(flightsCSV)}$scope.chosenOrigin="Choose origin",$scope.chosenDest="Choose destination",$scope.selectedOrigin=$scope.chosenOrigin,$scope.selectedDest=$scope.chosenDest,$scope.validateInputs=validateInputs,DataStore.getFlights().then(function(flightsCSV){return convertCsvToJson(flightsCSV)}).then(function(flightsJSON){getAllDest(flightsJSON)}).catch(function(err){console.error(err)})}angular.module("flightsOTP").controller("MainCtrl",mainCtrl),mainCtrl.$inject=["$scope","$state","DataStore","$csv"]}();